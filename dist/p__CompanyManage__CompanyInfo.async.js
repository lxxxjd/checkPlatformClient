(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[53],{gN26:function(e,a,t){"use strict";t.r(a);t("IzEo");var n,l,r,o,i=t("bx4M"),c=t("jehZ"),s=t.n(c),d=(t("g9YV"),t("wCAj")),p=(t("+L6B"),t("2/Rp")),m=t("d6i3"),u=t.n(m),f=t("1l/V"),y=t.n(f),g=t("p0pE"),h=t.n(g),b=t("2Taf"),v=t.n(b),E=t("vZ4D"),w=t.n(E),C=t("l4Ni"),V=t.n(C),k=t("ujKo"),I=t.n(k),M=t("MhPg"),x=t.n(M),F=(t("DZo9"),t("8z0m")),S=(t("Pwec"),t("CtXQ")),L=(t("miYZ"),t("tsqr")),O=(t("/xke"),t("TeRw")),R=t("eHn4"),D=t.n(R),N=(t("2qtc"),t("kLXV")),P=(t("y8nQ"),t("Vl3Y")),q=(t("OaEy"),t("2fM7")),j=(t("5NDa"),t("5rEg")),Y=t("q1tI"),z=t.n(Y),T=t("MuoO"),U=t("Y2fQ"),B=t("wd/R"),J=t.n(B);t("zHco"),t("V54k");function A(e){return function(){var a,t=I()(e);if(Z()){var n=I()(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return V()(this,a)}}function Z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var H=j["a"].TextArea,Q=q["a"].Option,K=P["a"].create()(function(e){var a=e.handleModifyModalVisble,t=e.form,n=e.modifyModalVisble,l=e.dispatch,r=e.init,o=(e.loading,e.fileList),i=e.previewVisible,c=e.previewImage,s=e.Cancel,d=e.handlePreview,p=e.handleBeforeUpload,m=e.setStateFileList,u=t.getFieldDecorator,f=function(e){var a=e.file,n=e.fileList,l="application/pdf"===a.type,r=a.size/1024/1024<20;if(l)if(r){var o=a.name,i=/\.{1}[a-z]{1,}$/;null!==i.exec(o)&&(o=o.slice(0,i.exec(o).index)),t.setFieldsValue(D()({},"recordname",o)),m(n)}else N["a"].error({title:"\u8d85\u8fc720M\u9650\u5236\uff0c\u4e0d\u5141\u8bb8\u4e0a\u4f20~"});else N["a"].error({title:"\u53ea\u80fd\u4e0a\u4f20PDF\u683c\u5f0f\u7684\u56fe\u7247~"})},y=function(e,a,t){void 0!==a&&null!==a&&""!==a||t(Object(U["formatMessage"])({id:"validation.recordcompany.noexist"}));var n=JSON.parse(localStorage.getItem("userinfo")),r=new FormData;r.append("certcode",n.certCode),r.append("recordname",a),l({type:"company/getRepeatRecordNameCompany",payload:r,callback:function(e){"repeat"===e?t(Object(U["formatMessage"])({id:"validation.recordcompany.repeat"})):"success"===e?t():t(Object(U["formatMessage"])({id:"validation.recordcompany.error"}))}})},g=function(){t.validateFields(function(e,n){if(!e){var o=new FormData,i=JSON.parse(localStorage.getItem("userinfo"));n.MultipartFile.fileList.forEach(function(e){o.append("file",e.originFileObj)}),o.append("certcode",i.certCode),o.append("recordname",n.recordname),o.append("creator",i.nameC),l({type:"company/uploadRecordCompany",payload:o,callback:function(e){400===e.code?O["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:e.message}):(L["a"].success("\u6dfb\u52a0\u6210\u529f"),r())}}),t.resetFields(),a()}})},h=z.a.createElement("div",null,z.a.createElement(S["a"],{type:"plus"}),z.a.createElement("div",{className:"ant-upload-text"},"Upload"));return z.a.createElement(N["a"],{destroyOnClose:!0,title:"\u4e0a\u4f20\u6587\u4ef6",visible:n,onOk:g,onCancel:function(){return a()},width:500,style:{top:20}},z.a.createElement(P["a"],null,z.a.createElement(P["a"].Item,{label:"\u6587\u4ef6\u4e0a\u4f20"},u("MultipartFile",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e0a\u4f20\u6587\u4ef6"}]})(z.a.createElement(F["a"],{listType:"picture-card",fileList:o,onPreview:d,beforeUpload:p,onChange:f},o.length>=1?null:h))),z.a.createElement(P["a"].Item,{label:"\u6587\u4ef6\u540d\u79f0"},u("recordname",{rules:[{required:!0,validator:y}]})(z.a.createElement(j["a"],{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u79f0"}))),z.a.createElement(N["a"],{visible:i,footer:null,onCancel:s},z.a.createElement("img",{alt:"example",style:{width:"100%"},src:c}))))}),X=(n=P["a"].create(),l=Object(T["connect"])(function(e){var a=e.company,t=e.loading;return{company:a,loading:t.models.company}}),n(r=l((o=function(e){x()(t,e);var a=A(t);function t(){var e;v()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return e=a.call.apply(a,[this].concat(l)),e.state={company:{},parents:[],modifyModalVisble:!1,previewVisible:!1,previewImage:"",fileList:[],dataSource:[]},e.columns=[{title:"\u6587\u4ef6\u540d\u79f0",dataIndex:"recordname",render:function(e){var a=/\.{1}[a-z]{1,}$/;return null!==a.exec(e)?z.a.createElement("span",null,e.slice(0,a.exec(e).index)):z.a.createElement("span",null,e)}},{title:"\u4e0a\u4f20\u65e5\u671f",dataIndex:"createtime",render:function(e){return z.a.createElement("span",null,J()(e).format("YYYY-MM-DD"))}},{title:"\u4e0a\u4f20\u4eba",dataIndex:"creator"},{title:"\u64cd\u4f5c",render:function(a,t){return z.a.createElement(Y["Fragment"],null,z.a.createElement("a",{onClick:function(){return e.previewItem(a,t)}},"\u67e5\u770b"),"\xa0\xa0",z.a.createElement("a",{onClick:function(){return e.deleteItem(a,t)}},"\u5220\u9664"),"\xa0\xa0")}}],e.init=function(){var a=e.props,t=a.dispatch,n=a.form,l=JSON.parse(localStorage.getItem("userinfo"));t({type:"company/getCompany",payload:{certCode:l.certCode},callback:function(a){200===a.code&&(e.setState({company:a.data}),n.setFieldsValue({namee:a.data.namee,adres:a.data.adres,account:a.data.account,bank:a.data.bank,belongto:a.data.belongto,cocode:a.data.cocode,tel:a.data.tel,explanation:a.data.explanation}))}}),t({type:"company/getParent",payload:{certCode:l.certCode},callback:function(a){200===a.code&&e.setState({parents:a.data})}}),t({type:"company/getRecordCompanyList",payload:{certCode:l.certCode},callback:function(a){200===a.code&&e.setState({dataSource:a.data})}})},e.handleSubmit=function(){var a=e.props,t=a.form,n=a.dispatch,l=t.validateFieldsAndScroll,r=e.state.company;l(function(a,l){a||(r.namee=t.getFieldValue("namee"),r.adres=t.getFieldValue("adres"),r.account=t.getFieldValue("account"),r.bank=t.getFieldValue("bank"),r.belongto=t.getFieldValue("belongto"),r.cocode=t.getFieldValue("cocode"),r.tel=t.getFieldValue("tel"),r.explanation=t.getFieldValue("explanation"),n({type:"company/updateCompany",payload:h()({},r),callback:function(a){200===a.code?(O["a"].open({message:"\u4fee\u6539\u6210\u529f"}),e.componentDidMount()):O["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:a.data})}}))})},e.previewItem=function(a){var t=e.props.dispatch;t({type:"company/getUrl",payload:{url:a.osspath},callback:function(e){if(400===e.code)O["a"].open({message:"\u6253\u5f00\u5931\u8d25",description:e.data});else{var a=e.data;window.open(a)}}})},e.deleteItem=function(a){N["a"].confirm({title:"\u786e\u5b9a\u5220\u9664\u6b64\u6587\u4ef6\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=e.props.dispatch;t({type:"company/deleteRecordCompany",payload:a,callback:function(a){console.log(a),"success"===a?(L["a"].success("\u5220\u9664\u6210\u529f"),e.init()):L["a"].error("\u5220\u9664\u5931\u8d25")}})}})},e.handleModifyModalVisble=function(a){e.setState({modifyModalVisble:!!a})},e.openModal=function(){e.setState({modifyModalVisble:!0})},e.Cancel=function(){return e.setState({previewVisible:!1})},e.handlePreview=function(){var a=y()(u.a.mark(function a(t){return u.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,getBase64(t.originFileObj);case 3:t.preview=a.sent;case 4:e.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),e.setStateFileList=function(a){e.setState({fileList:a})},e.handleBeforeUpload=function(e){return!1},e}return w()(t,[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){var e=this.props,a=e.loading,t=e.dispatch,n=this.props.form.getFieldDecorator,l={labelCol:{span:6},wrapperCol:{span:14}},r=this.state,o=r.company,c=r.parents,m=r.dataSource,u=r.fileList,f=r.previewVisible,y=r.previewImage,g=c.map(function(e){return z.a.createElement(Q,{key:e.certcode,value:e.certcode},e.namec)}),h={handleModifyModalVisble:this.handleModifyModalVisble,Cancel:this.Cancel,handleBeforeUpload:this.handleBeforeUpload,handlePreview:this.handlePreview,init:this.init,setStateFileList:this.setStateFileList,getRepeatName:this.getRepeatName},b=this.state.modifyModalVisble;return z.a.createElement(i["a"],null,z.a.createElement(P["a"],l,z.a.createElement(P["a"].Item,{label:"\u516c\u53f8\u540d\u79f0"},z.a.createElement("span",{className:"ant-form-text"},o.namec)),z.a.createElement(P["a"].Item,{label:"\u82f1\u6587\u540d\u79f0"},n("namee",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u82f1\u6587\u540d"}]})(z.a.createElement(j["a"],null))),z.a.createElement(P["a"].Item,{label:"\u5730\u5740"},n("adres",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5730\u5740"}]})(z.a.createElement(j["a"],null))),z.a.createElement(P["a"].Item,{label:"\u94f6\u884c\u8d26\u6237"},n("account",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u94f6\u884c\u8d26\u6237"}]})(z.a.createElement(j["a"],null))),z.a.createElement(P["a"].Item,{label:"\u793e\u4f1a\u7edf\u4e00\u4fe1\u7528\u4ee3\u7801"},n("cocode",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u793e\u4f1a\u7edf\u4e00\u4fe1\u7528\u4ee3\u7801"}]})(z.a.createElement(j["a"],null))),z.a.createElement(P["a"].Item,{label:"\u5f00\u6237\u884c"},n("bank",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5f00\u6237\u884c"}]})(z.a.createElement(j["a"],null))),z.a.createElement(P["a"].Item,{label:"\u4e1a\u52a1\u54a8\u8be2\u7535\u8bdd"},n("tel",{rules:[]})(z.a.createElement(j["a"],{placeholder:"\u8bf7\u8f93\u5165\u4e1a\u52a1\u54a8\u8be2\u7535\u8bdd"}))),z.a.createElement(P["a"].Item,{label:"\u6bcd\u516c\u53f8"},n("belongto",{})(z.a.createElement(q["a"],{placeholder:"\u8bf7\u9009\u62e9\u6bcd\u516c\u53f8",filterOption:!1},g))),z.a.createElement(P["a"].Item,{label:"\u80fd\u529b\u8bf4\u660e"},n("explanation",{rules:[]})(z.a.createElement(H,{placeholder:"\u8bf7\u8f93\u5165\u80fd\u529b\u8bf4\u660e,\u4e0d\u8d85\u8fc750\u4e2a\u5b57",style:{minHeight:32},rows:3,maxLength:50}))),z.a.createElement(P["a"].Item,{label:"\u8bf7\u4e0a\u4f20"},z.a.createElement("span",null,"\u8425\u4e1a\u6267\u7167\u3001\u8d44\u8d28\u8bc1\u4e66\u7b49"),z.a.createElement(p["a"],{style:{marginLeft:10},type:"primary",onClick:this.openModal},"\u4e0a\u4f20")),z.a.createElement(P["a"].Item,{wrapperCol:{span:14,offset:6}},z.a.createElement("div",{style:{width:"100%"}},z.a.createElement(d["a"],{size:"middle",loading:a,dataSource:m,columns:this.columns,rowKey:"recordname"})),z.a.createElement(p["a"],{style:{marginTop:10},type:"primary",onClick:this.handleSubmit},"\u4fdd\u5b58"))),z.a.createElement(K,s()({},h,{modifyModalVisble:b,dispatch:t,loading:a,fileList:u,previewVisible:f,previewImage:y})))}}]),t}(Y["PureComponent"]),r=o))||r)||r);a["default"]=X}}]);