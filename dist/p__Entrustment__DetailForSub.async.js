(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[89],{Lse9:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,s,o,r,l=a("bx4M"),i=(a("g9YV"),a("wCAj")),c=(a("14J3"),a("BMrR")),p=(a("Pwec"),a("CtXQ")),m=(a("jCWc"),a("kPKH")),u=(a("+L6B"),a("2/Rp")),d=(a("7Kak"),a("9yH6")),f=(a("2qtc"),a("kLXV")),y=a("eHn4"),g=a.n(y),h=(a("/xke"),a("TeRw")),w=a("2Taf"),v=a.n(w),I=a("vZ4D"),b=a.n(I),k=a("l4Ni"),E=a.n(k),S=a("ujKo"),C=a.n(S),F=a("MhPg"),x=a.n(F),V=(a("y8nQ"),a("Vl3Y")),N=(a("5NDa"),a("5rEg")),O=(a("OaEy"),a("2fM7")),P=(a("sRBo"),a("kaz8")),q=a("q1tI"),R=a.n(q),M=a("MuoO"),j=a("zHco"),L=a("oODe"),B=a.n(L);function D(e){return function(){var t,a=C()(e);if(T()){var n=C()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return E()(this,t)}}function T(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var z=P["a"].Group,A=O["a"].Option,J=N["a"].TextArea,H=(n=V["a"].create(),s=Object(M["connect"])(function(e){var t=e.testInfo,a=e.loading;return{testInfo:t,loading:a.models.testInfo}}),n(o=s((r=function(e){x()(a,e);var t=D(a);function a(){var e;v()(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),e.state={visible:!1,checkProject:[],allCompanyName:[],selectEntrustment:null,showPrice:!1,report:null,priceMakeing:null,overallstate:void 0,isViewCompany:!1},e.columns=[{title:"\u53d7\u59d4\u6258\u516c\u53f8",dataIndex:"testman"},{title:"\u8f6c\u59d4\u6258\u9879\u76ee",dataIndex:"inspway"},{title:"\u8ba1\u4ef7\u65b9\u5f0f",dataIndex:"priceway"},{title:"\u5355\u4ef7",dataIndex:"price"},{title:"\u603b\u4ef7",dataIndex:"totalfee"},{title:"\u8f6c\u59d4\u6258\u8981\u6c42",dataIndex:"inspwaymemo1"},{title:"\u64cd\u4f5c",render:function(t,a){return R.a.createElement(q["Fragment"],null,"\u5df2\u53d1\u5e03"!==e.state.overallstate&&"\u7533\u8bf7\u4f5c\u5e9f"!==e.state.overallstate?[R.a.createElement("a",{onClick:function(){return e.modifyItem(t,a)}},"\u4fee\u6539\xa0\xa0")]:[],"\u5df2\u53d1\u5e03"!==e.state.overallstate&&"\u7533\u8bf7\u4f5c\u5e9f"!==e.state.overallstate?[R.a.createElement("a",{onClick:function(){return e.deleteItem(t,a)}},"\u5220\u9664\xa0\xa0")]:[])}}],e.columns2=[{title:"\u53d7\u59d4\u6258\u516c\u53f8",dataIndex:"testman"},{title:"\u8f6c\u59d4\u6258\u9879\u76ee",dataIndex:"inspway"},{title:"\u8ba1\u4ef7\u65b9\u5f0f",dataIndex:"priceway"},{title:"\u5355\u4ef7",dataIndex:"price"},{title:"\u603b\u4ef7",dataIndex:"totalfee"},{title:"\u8f6c\u59d4\u6258\u8981\u6c42",dataIndex:"inspwaymemo1"}],e.deleteItem=function(t){var a=e.props.dispatch;a({type:"testInfo/deleteTestBySampleNo",payload:{keyno:t.keyno},callback:function(t){200===t.code?(e.componentDidMount(),h["a"].open({message:"\u5220\u9664\u6210\u529f"})):h["a"].open({message:"\u5220\u9664\u5931\u8d25",description:t.data})}})},e.modifyItem=function(t){var a=e.props.form;if(e.setState({visible:!0}),e.setState({selectEntrustment:t}),t.inspway&&"undefined"!==typeof t.inspway){var n=t.inspway.split(" ");a.setFieldsValue(g()({},"inspway",n))}var s=sessionStorage.getItem("inspway").split(" ");e.setState({checkProject:s}),a.setFieldsValue(g()({},"testman",t.testman)),a.setFieldsValue(g()({},"price",t.price)),a.setFieldsValue(g()({},"priceway",t.priceway)),a.setFieldsValue(g()({},"totalfee",t.totalfee)),a.setFieldsValue(g()({},"inspwaymemo1",t.inspwaymemo1)),e.setState({showPrice:t.priceway})},e.handleOk=function(){var t=e.props,a=t.form.validateFieldsAndScroll,n=t.dispatch,s=e.state.selectEntrustment;a(function(t,a){if(!t){if(a.nameC=JSON.parse(localStorage.getItem("userinfo")).nameC,s&&"undefined"!==typeof s)a.keyno=s.keyno,a.reportno=s.reportno,a.assignman=s.assignman,a.inspway=a.inspway.join(" "),n({type:"testInfo/updateTestInfo",payload:a});else{var o=sessionStorage.getItem("reportno");a.reportno=o,a.inspway=a.inspway.join(" "),n({type:"testInfo/addTestInfo",payload:a,callback:function(e){200===e.code?h["a"].open({message:"\u6dfb\u52a0\u6210\u529f"}):h["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:e.data})}})}e.setState({selectEntrustment:null}),e.setState({visible:!1}),form.resetFields()}})},e.show=function(){var t=e.state.report,a=sessionStorage.getItem("inspway").split(" ");e.setState({checkProject:a});var n=e.props.form;n.resetFields(),n.setFieldsValue(g()({},"inspwaymemo1",t.inspwaymemo1)),e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e.onChange=function(t){var a=e.props.form;e.setState({showPrice:t.target.value}),a.setFieldsValue(g()({},"price",null)),a.setFieldsValue(g()({},"totalfee",null))},e.back=function(){e.props.history.goBack()},e.sum=function(){var t=e.props.form,a=e.state,n=a.report,s=a.priceMakeing,o=a.showPrice,r=t.getFieldValue("price");""!==r&&void 0!==r&&("\u6309\u5355\u4ef7"===o?""!==s.quantity&&null!==s.quantity?t.setFieldsValue(g()({},"totalfee",r*parseFloat(s.quantity))):""!==n.quantityd&&null!==n.quantityd&&t.setFieldsValue(g()({},"totalfee",Number(r)*parseFloat(n.quantityd))):"\u6309\u6bd4\u4f8b"===o&&""!==s.total&&null!==s.total&&t.setFieldsValue(g()({},"totalfee",r*parseFloat(s.total))))},e.onAllCompanyNameFocus=function(t){void 0!==e.state.allCompanyName&&0!==e.state.allCompanyName.length||!1!==e.state.isViewCompany||(f["a"].info({title:"\u8f6c\u59d4\u6258\u4fe1\u606f\u672a\u914d\u7f6e",content:"\u8bf7\u7ba1\u7406\u5458\u5728\u201c\u516c\u53f8\u7ba1\u7406-\u5206\u5305\u65b9\u201d\u83dc\u5355\u914d\u7f6e\uff01",okText:"\u77e5\u9053\u4e86",onOk:function(){}}),e.state.isViewCompany=!0)},e}return b()(a,[{key:"componentDidMount",value:function(){var e=this,t=sessionStorage.getItem("overallstate");this.setState({overallstate:t});var a=this.props.dispatch,n=JSON.parse(localStorage.getItem("userinfo")).certCode,s=sessionStorage.getItem("reportno");a({type:"testInfo/getTestByReportNo",payload:{reportno:s}}),a({type:"testInfo/getCompany",payload:{certCode:n,type:"\u68c0\u9a8c\u673a\u6784"},callback:function(t){e.setState({allCompanyName:t})}}),a({type:"testInfo/getPriceMaking",payload:{reportno:s},callback:function(t){e.setState({priceMakeing:t})}}),a({type:"testInfo/getReport",payload:{reportno:s},callback:function(t){e.setState({report:t})}})}},{key:"render",value:function(){var e=this.props,t=e.testInfo.TestInfo,a=e.loading,n=e.form.getFieldDecorator,s=sessionStorage.getItem("reportno"),o=sessionStorage.getItem("shipname"),r=sessionStorage.getItem("applicant"),y={reportno:s,shipname:o,applicant:r},g=this.state,h=g.showPrice,w=g.checkProject,v=g.allCompanyName,I=g.visible,b=v.map(function(e){return R.a.createElement(A,{key:e,value:e},e)});return R.a.createElement(j["a"],{text:y},R.a.createElement(f["a"],{title:"\u8f6c\u59d4\u6258",visible:I,onOk:this.handleOk,onCancel:this.handleCancel},R.a.createElement(V["a"],null,R.a.createElement(V["a"].Item,{label:"\u53d7\u59d4\u6258\u516c\u53f8"},n("testman",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8f6c\u59d4\u6258\u516c\u53f8"}]})(R.a.createElement(O["a"],{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9",filterOption:!1,onSearch:this.handleSearch,onFocus:this.onAllCompanyNameFocus},b))),R.a.createElement(V["a"].Item,{label:"\u8f6c\u59d4\u6258\u9879\u76ee"},n("inspway",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8f6c\u59d4\u6258\u9879\u76ee"}]})(R.a.createElement(z,{options:w}))),R.a.createElement(V["a"].Item,{label:"\u8ba1\u4ef7\u65b9\u5f0f"},n("priceway",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8ba1\u4ef7\u65b9\u5f0f"}]})(R.a.createElement(d["a"].Group,{onChange:this.onChange},R.a.createElement(d["a"],{value:"\u6309\u5355\u4ef7"},"\u6309\u5355\u4ef7"),R.a.createElement(d["a"],{value:"\u6309\u6279\u6b21"},"\u6309\u6279\u6b21"),R.a.createElement(d["a"],{value:"\u6309\u6bd4\u4f8b"},"\u6309\u6bd4\u4f8b")))),"\u6309\u5355\u4ef7"===h?[R.a.createElement(V["a"].Item,{label:"\u5355\u4ef7"},n("price",{rules:"\u6309\u5355\u4ef7"===h?[{required:!0,whitespace:!0,type:"number",transform:function(e){if(e)return Number(e)},message:"\u8bf7\u8f93\u5165\u6570\u5b57"}]:[]})(R.a.createElement(N["a"],{onBlur:this.sum})))]:[],"\u6309\u6bd4\u4f8b"===h?[R.a.createElement(V["a"].Item,{label:"\u6bd4\u4f8b"},n("price",{rules:"\u6309\u6bd4\u4f8b"===h?[{required:!0,whitespace:!0,type:"number",transform:function(e){if(e)return Number(e)},message:"\u8bf7\u8f93\u5165\u6570\u5b57"}]:[]})(R.a.createElement(N["a"],{onBlur:this.sum})))]:[],R.a.createElement(V["a"].Item,{label:"\u603b\u8ba1\u8d39\u7528"},n("totalfee",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u603b\u8ba1\u8d39\u7528"}]})(R.a.createElement(N["a"],null))),R.a.createElement(V["a"].Item,{label:"\u8f6c\u59d4\u6258\u8981\u6c42"},n("inspwaymemo1")(R.a.createElement(J,{style:{minHeight:32},rows:4}))))),R.a.createElement(l["a"],{bordered:!1,size:"small"},R.a.createElement(c["a"],null,R.a.createElement(m["a"],{span:22},"\u5df2\u53d1\u5e03"===this.state.overallstate||"\u7533\u8bf7\u4f5c\u5e9f"===this.state.overallstate?[]:R.a.createElement(u["a"],{style:{marginBottom:12},type:"primary",onClick:this.show},"\u65b0\u5efa")),R.a.createElement(m["a"],{span:2},R.a.createElement(u["a"],{type:"primary",style:{marginLeft:8,paddingLeft:0,paddingRight:15},onClick:this.back},R.a.createElement(p["a"],{type:"left"}),"\u8fd4\u56de"))),R.a.createElement("div",{className:B.a.tableList},R.a.createElement(i["a"],{size:"middle",loading:a,dataSource:t,columns:"\u5df2\u53d1\u5e03"===this.state.overallstate||"\u7533\u8bf7\u4f5c\u5e9f"===this.state.overallstate?this.columns2:this.columns,rowKey:"testman",pagination:{showQuickJumper:!0,showSizeChanger:!0}}))))}}]),a}(q["PureComponent"]),o=r))||o)||o);t["default"]=H},oODe:function(e,t,a){e.exports={tableList:"antd-pro-pages-entrustment-detail-for-sub-tableList",tableListOperator:"antd-pro-pages-entrustment-detail-for-sub-tableListOperator",card:"antd-pro-pages-entrustment-detail-for-sub-card",headerInfo:"antd-pro-pages-entrustment-detail-for-sub-headerInfo"}}}]);