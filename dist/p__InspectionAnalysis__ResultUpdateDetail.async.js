(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[114],{gZ96:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,i,l,r,s=a("bx4M"),o=(a("g9YV"),a("wCAj")),c=a("jehZ"),d=a.n(c),u=(a("14J3"),a("BMrR")),p=(a("Pwec"),a("CtXQ")),m=(a("jCWc"),a("kPKH")),f=a("gWZ8"),v=a.n(f),h=(a("/xke"),a("TeRw")),g=a("p0pE"),y=a.n(g),b=a("2Taf"),S=a.n(b),E=a("vZ4D"),k=a.n(E),C=a("l4Ni"),w=a.n(C),I=a("ujKo"),x=a.n(I),L=a("MhPg"),V=a.n(L),R=a("Y/ft"),O=a.n(R),A=(a("5NDa"),a("5rEg")),D=(a("2qtc"),a("kLXV")),M=(a("+L6B"),a("2/Rp")),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),P=a("q1tI"),U=a.n(P),q=a("MuoO"),B=a("zHco"),J=a("RdVf"),T=a.n(J),j=a("sURl"),z=a.n(j);a("17x9");function K(e){return function(){var t,a=x()(e);if(Z()){var n=x()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return w()(this,t)}}function Z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}N["a"].Item;var Q=F["a"].Option,W=N["a"].create()(function(e){var t=e.form,a=e.modalSaveListVisible,n=e.handleModalSaveListVisible,i=e.handleSaveList,l=e.reviewUsersOptions,r=function(){t.validateFields(function(e,a){e||(i(a),t.resetFields(),n())})};return U.a.createElement(D["a"],{destroyOnClose:!0,title:"\u63d0\u4ea4\u5ba1\u6838",visible:a,style:{top:100},width:500,onCancel:function(){return n()},footer:[U.a.createElement(M["a"],{type:"primary",onClick:function(){return n()}},"\u5173\u95ed"),U.a.createElement(M["a"],{type:"primary",onClick:function(){return r()}},"\u4fdd\u5b58")]},U.a.createElement(N["a"],null,U.a.createElement(N["a"].Item,{labelCol:{span:6},wrapperCol:{span:16},label:"\u5ba1\u6838\u4eba\uff1a"},t.getFieldDecorator("reviewer",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5ba1\u6838\u4eba"}]})(U.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6838\u4eba"},l)))))}),Y=N["a"].create()(function(e){var t=e.form,a=e.visible,n=e.handleVisible,i=e.handleOk,l=(e.result,e.testDetail),r=function(){t.validateFields(function(e,a){e||(i(a),t.resetFields(),n())})};return U.a.createElement(D["a"],{destroyOnClose:!0,title:"\u5f55\u5165\u6837\u54c1\u6307\u6807",visible:a,style:{top:100},width:500,onCancel:function(){return n()},footer:[U.a.createElement(M["a"],{type:"primary",onClick:function(){return n()}},"\u5173\u95ed"),U.a.createElement(M["a"],{type:"primary",onClick:function(){return r()}},"\u4fdd\u5b58")]},U.a.createElement(N["a"],null,U.a.createElement(N["a"].Item,{label:"\u7ed3\u679c"},t.getFieldDecorator("result",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7ed3\u679c"}],initialValue:l.testresult})(U.a.createElement(A["a"],{placeholder:"\u8bf7\u8f93\u5165\u7ed3\u679c"})))))}),H=U.a.createContext(),X=function(e){var t=e.form,a=(e.index,O()(e,["form","index"]));return U.a.createElement(H.Provider,{value:t},U.a.createElement("tr",a))},G=N["a"].create()(X),$=function(e){V()(a,e);var t=K(a);function a(){var e;S()(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),e.state={editing:!1},e.toggleEdit=function(){var t=!e.state.editing;e.setState({editing:t},function(){t&&e.input.focus()})},e.save=function(t){var a=e.props,n=a.record,i=a.handleSave;e.form.validateFields(function(a,l){a&&a[t.currentTarget.id]||(e.toggleEdit(),i(y()({},n,l)))})},e.renderCell=function(t){e.form=t;var a=e.props,n=a.children,i=a.dataIndex,l=a.record,r=a.title,s=e.state.editing;return s?U.a.createElement(N["a"].Item,{style:{margin:0}},t.getFieldDecorator(i,{rules:[{required:!0,message:"".concat(r," is required.")}],initialValue:l[i]})(U.a.createElement(A["a"],{ref:function(t){return e.input=t},onPressEnter:e.save,onBlur:e.save}))):U.a.createElement("div",{className:z.a.editableCellValueWrap,style:{paddingRight:24},onClick:e.toggleEdit},n)},e}return k()(a,[{key:"render",value:function(){var e=this.props,t=e.editable,a=(e.dataIndex,e.title,e.record,e.index,e.handleSave,e.children),n=O()(e,["editable","dataIndex","title","record","index","handleSave","children"]);return U.a.createElement("td",n,t?U.a.createElement(H.Consumer,null,this.renderCell):a)}}]),a}(U.a.Component),_=(n=Object(q["connect"])(function(e){var t=e.inspectionAnalysis,a=e.loading;return{inspectionAnalysis:t,loading:a.models.inspectionAnalysis}}),i=N["a"].create(),n(l=i((r=function(e){V()(a,e);var t=K(a);function a(){var e;S()(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),e.state={formValues:{},visible:!1,editingKey:"",testDetail:{},dataSource:[],modalSaveListVisible:!1,reviewUsers:[]},e.columns=[{title:"\u6307\u6807\u540d\u79f0",dataIndex:"itemC"},{title:"\u82f1\u6587\u540d\u79f0",dataIndex:"itemE"},{title:"\u68c0\u6d4b\u6807\u51c6",dataIndex:"teststandard"},{title:"\u5355\u4f4d",dataIndex:"unit"},{title:"\u7ed3\u679c",dataIndex:"testresult",editable:!0,width:"15%"},{title:"\u64cd\u4f5c",render:function(t,a){return U.a.createElement(P["Fragment"],null,U.a.createElement("a",{onClick:function(){return e.modifyItem(t,a)}},"\u4fee\u6539"))}}],e.init=function(){var t=e.props.dispatch,a=sessionStorage.getItem("reportno"),n=sessionStorage.getItem("sampleno");t({type:"inspectionAnalysis/getAllDetails",payload:{reportno:a,sampleno:n},callback:function(t){if(t&&void 0!==t.length){for(var a=0;a<t.length;a++)void 0!==t[a].testresult&&null!==t[a].testresult||(t[a].testresult=0);e.state.dataSource=t}}})},e.back=function(){e.props.history.goBack()},e.handleModalSaveListVisible=function(t){e.setState({modalSaveListVisible:!!t})},e.handleSaveList=function(t){e.saveAll(t.reviewer)},e.handleOk=function(t){var a=e.state.testDetail,n=a,i=e.props.dispatch;n.testresult=t.result,i({type:"inspectionAnalysis/addResult",payload:n,callback:function(e){200===e.code?h["a"].open({message:"\u5f55\u5165\u6210\u529f"}):h["a"].open({message:"\u5f55\u5165\u5931\u8d25",description:e.data})}}),e.setState({visible:!1})},e.handleCancel=function(){e.setState({visible:!1})},e.handleVisible=function(t){e.setState({visible:!!t})},e.modifyItem=function(t){e.setState({testDetail:t}),e.handleVisible(!0)},e.openSaveModal=function(){var t=e.props.dispatch,a=JSON.parse(localStorage.getItem("userinfo"));t({type:"user/getMan",payload:{certcode:a.certCode,func:"\u7ed3\u679c\u590d\u6838"},callback:function(t){void 0===t||null===t||0===t.length?D["a"].info({title:"\u5b9e\u9a8c\u5ba4\u4e3b\u4efb\u4fe1\u606f\u672a\u914d\u7f6e",content:"\u8bf7\u7ba1\u7406\u5458\u5728\u201c\u516c\u53f8\u7ba1\u7406-\u7528\u6237\u7ba1\u7406\u201d\u83dc\u5355\u914d\u7f6e\uff0c\u5e76\u5728\u89d2\u8272\u4e2d\u52a0\u9009\u5b9e\u9a8c\u5ba4\u4e3b\u4efb\u89d2\u8272\uff01",okText:"\u77e5\u9053\u4e86",onOk:function(){}}):(e.setState({reviewUsers:t}),e.handleModalSaveListVisible(!0))}})},e.handleSave=function(t){var a=v()(e.state.dataSource),n=a.findIndex(function(e){return t.keyno===e.keyno}),i=a[n];a.splice(n,1,y()({},i,t)),e.setState({dataSource:a})},e.saveAll=function(t){for(var a=e.state.dataSource,n=[],i=0,l=0;l<a.length;l++)n.push(a[l]),null!==a[l].testresult&&void 0!==a[l].testresult&&"0"!==a[l].testresult||(i=1);1===i?D["a"].confirm({title:"\u5b58\u5728\u6307\u6807\u7ed3\u679c\u4e3a0\uff0c\u786e\u8ba4\u63d0\u4ea4\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){e.saveAllList(t,n)}}):e.saveAllList(t,n)},e.saveAllList=function(t,a){var n=JSON.parse(localStorage.getItem("userinfo")),i=e.props.dispatch,l={details:a,reviewer:t,certcode:n.certCode};i({type:"inspectionAnalysis/saveResultList",payload:l,callback:function(t){"success"===t?(h["a"].open({message:"\u4fdd\u5b58\u6210\u529f"}),e.init()):h["a"].open({message:"\u4fdd\u5b58\u5931\u8d25",description:t.data})}})},e}return k()(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){var e=this,t=this.props.loading,a=this.state,n=a.visible,i=a.dataSource,l=a.modalSaveListVisible,r=a.reviewUsers,c=a.testDetail,f=r.map(function(e){return U.a.createElement(Q,{value:e.userName},e.nameC)}),v={handleModalSaveListVisible:this.handleModalSaveListVisible,handleSaveList:this.handleSaveList,handleVisible:this.handleVisible,handleOk:this.handleOk},h=sessionStorage.getItem("reportno"),g=sessionStorage.getItem("shipname"),b=sessionStorage.getItem("sampleno"),S={reportno:h,shipname:g,sampleno:b},E={body:{row:G,cell:$}},k=this.columns.map(function(t){return t.editable?y()({},t,{onCell:function(a){return{record:a,editable:t.editable,dataIndex:t.dataIndex,title:t.title,handleSave:e.handleSave}}}):t});return U.a.createElement(B["a"],{text:S},U.a.createElement(s["a"],{bordered:!1,size:"small"},U.a.createElement(u["a"],null,U.a.createElement(m["a"],{sm:22},U.a.createElement(M["a"],{style:{marginBottom:12,marginRight:12},type:"primary",onClick:this.openSaveModal},"\u63d0\u4ea4"),U.a.createElement(M["a"],{style:{marginBottom:12,marginRight:12},type:"primary",onClick:this.init},"\u91cd\u7f6e")),U.a.createElement(m["a"],{span:2},U.a.createElement(M["a"],{type:"primary",style:{marginLeft:8,paddingLeft:0,paddingRight:15},onClick:this.back},U.a.createElement(p["a"],{type:"left"}),"\u8fd4\u56de"))),U.a.createElement(W,d()({},v,{modalSaveListVisible:l,reviewUsersOptions:f})),U.a.createElement(Y,d()({},v,{visible:n,testDetail:c})),U.a.createElement("div",{className:T.a.tableList},U.a.createElement(o["a"],{size:"middle",components:E,dataSource:i,columns:k,pagination:{showQuickJumper:!0,showSizeChanger:!0},loading:t,rowKey:"keyno"}))))}}]),a}(P["PureComponent"]),l=r))||l)||l);t["default"]=_},sURl:function(e,t,a){e.exports={"editable-cell":"antd-pro-pages-inspection-analysis-result-update-editable-cell","editable-cell-value-wrap":"antd-pro-pages-inspection-analysis-result-update-editable-cell-value-wrap","editable-row":"antd-pro-pages-inspection-analysis-result-update-editable-row"}}}]);