(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{GheW:function(e,a,t){"use strict";t.r(a);t("IzEo");var r,s,n,o,l=t("bx4M"),i=t("jehZ"),c=t.n(i),d=(t("Q9mQ"),t("diRs")),m=(t("+L6B"),t("2/Rp")),p=(t("miYZ"),t("tsqr")),u=(t("MXD1"),t("CFYs")),f=(t("/xke"),t("TeRw")),h=t("p0pE"),g=t.n(h),w=t("2Taf"),y=t.n(w),b=t("vZ4D"),v=t.n(b),E=t("l4Ni"),P=t.n(E),S=t("ujKo"),k=t.n(S),V=t("MhPg"),I=t.n(V),O=(t("2qtc"),t("kLXV")),N=(t("5NDa"),t("5rEg")),C=(t("y8nQ"),t("Vl3Y")),F=t("q1tI"),D=t.n(F),M=t("MuoO"),x=t("3a4m"),Y=t.n(x),J=(t("zHco"),t("Y2fQ")),R=t("V54k"),q=t.n(R),z=t("wd/R"),j=t.n(z);function L(e){return function(){var a,t=k()(e);if(Q()){var r=k()(this).constructor;a=Reflect.construct(t,arguments,r)}else a=t.apply(this,arguments);return P()(this,a)}}function Q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var U={ok:D.a.createElement("div",{className:q.a.success},D.a.createElement(J["FormattedMessage"],{id:"validation.password.strength.strong"})),pass:D.a.createElement("div",{className:q.a.warning},D.a.createElement(J["FormattedMessage"],{id:"validation.password.strength.medium"})),poor:D.a.createElement("div",{className:q.a.error},D.a.createElement(J["FormattedMessage"],{id:"validation.password.strength.short"}))},T={ok:"success",pass:"normal",poor:"exception"},Z=C["a"].create()(function(e){var a=e.form,t=e.handleOld,r=e.handleOldPasswordVisible,s=e.OldPasswordVisible,n=function(){a.validateFields(function(e,r){e||(a.resetFields(),t(r))})},o=function(e,t,r){t&&t!==a.getFieldValue("oldpassword")?r("\u5bc6\u7801\u4e0d\u4e00\u81f4"):r()};return D.a.createElement(O["a"],{title:"\u786e\u8ba4\u539f\u5bc6\u7801",style:{top:100},visible:s,onOk:n,onCancel:function(){return r()}},D.a.createElement(C["a"].Item,{labelCol:{span:5},wrapperCol:{span:15},label:"\u539f\u5bc6\u7801"},a.getFieldDecorator("oldpassword",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801"}]})(D.a.createElement(N["a"],{placeholder:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801",type:"password"}))),D.a.createElement(C["a"].Item,{labelCol:{span:5},wrapperCol:{span:15},label:"\u786e\u8ba4\u539f\u5bc6\u7801"},a.getFieldDecorator("oldconfirm",{rules:[{required:!0,message:"\u8bf7\u518d\u6b21\u8f93\u5165\u539f\u5bc6\u7801"},{validator:o}]})(D.a.createElement(N["a"],{placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u539f\u5bc6\u7801",type:"password"}))))}),A=(r=C["a"].create(),s=Object(M["connect"])(function(e){var a=e.company,t=e.loading;return{company:a,loading:t.models.company}}),r(n=s((o=function(e){I()(t,e);var a=L(t);function t(){var e;y()(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return e=a.call.apply(a,[this].concat(s)),e.state={user:{},parents:[],passwordVisible:!1,visible:!1,help:""},e.handleSubmit=function(){var a=e.props,t=a.form,r=a.dispatch,s=t.validateFieldsAndScroll,n=JSON.parse(localStorage.getItem("userinfo"));s(function(a,t){a||r({type:"company/updateUser",payload:g()({userName:n.userName,nameC:n.nameC,role:n.role,isauthorize:n.isauthorize},t),callback:function(a){200===a.code?(r({type:"company/getUser",payload:{name:n.userName},callback:function(a){200===a.code&&(localStorage.setItem("userinfo",JSON.stringify(a.data)),e.componentDidMount())}}),f["a"].open({message:"\u4fee\u6539\u6210\u529f"})):f["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:a.data})}})})},e.handlePasswordVisible=function(a){e.setState({passwordVisible:!!a})},e.handleOldPasswordVisible=function(a){e.setState({OldPasswordVisible:!!a})},e.showPassword=function(){e.handleOldPasswordVisible(!0)},e.showPersonalInfo=function(){sessionStorage.setItem("usertext",localStorage.getItem("userinfo")),Y.a.push({pathname:"/CompanyManage/ManDetail"})},e.checkPassword=function(a,t,r){!1===e.state.passwordVisible&&r();var s=e.props.form;console.log(s.validateFields(["confirm"]));var n=e.state,o=n.confirmDirty,l=n.visible;t?(e.setState({help:""}),l||e.setState({visible:!!t}),t.length<6?r("error"):(t&&o&&s.validateFields(["confirm"],{force:!0}),r())):(e.setState({help:"\u8bf7\u8f93\u5165\u5bc6\u7801",visible:!!t}),r("error"))},e.getPasswordStatus=function(){var a=e.props.form,t=a.getFieldValue("password");return t&&t.length>9?"ok":t&&t.length>5?"pass":"poor"},e.renderPasswordProgress=function(){var a=e.props.form,t=a.getFieldValue("password"),r=e.getPasswordStatus();return t&&t.length?D.a.createElement("div",{className:q.a["progress-".concat(r)]},D.a.createElement(u["a"],{status:T[r],className:q.a.progress,strokeWidth:6,percent:10*t.length>100?100:10*t.length,showInfo:!1})):null},e.checkConfirm=function(a,t,r){var s=e.props.form;t&&t!==s.getFieldValue("password")?r("\u5bc6\u7801\u4e0d\u4e00\u81f4"):r()},e.modifyPassword=function(){var a=e.props,t=a.form,r=a.dispatch,s=JSON.parse(localStorage.getItem("userinfo")),n=g()({},s);n.password=t.getFieldValue("password"),r({type:"company/updateUser",payload:n,callback:function(a){200===a.code?(r({type:"company/getUser",payload:{name:s.userName},callback:function(a){200===a.code&&(localStorage.setItem("userinfo",JSON.stringify(a.data)),e.componentDidMount())}}),f["a"].open({message:"\u4fee\u6539\u6210\u529f"})):f["a"].open({message:"\u6dfb\u52a0\u5931\u8d25",description:a.data})}}),e.handlePasswordVisible(!1)},e.handleOld=function(a){var t=JSON.parse(localStorage.getItem("userinfo"));a.oldpassword===t.password?e.handlePasswordVisible(!0):p["a"].error("\u60a8\u7684\u539f\u5bc6\u7801\u786e\u8ba4\u9519\u8bef"),e.handleOldPasswordVisible(!1)},e}return v()(t,[{key:"componentDidMount",value:function(){var e=this.props.form,a=JSON.parse(localStorage.getItem("userinfo"));e.setFieldsValue({place:a.place,section:a.section,tel:a.tel,sex:a.sex,birthday:null!==a.birthday&&void 0!==a.birthday?j()(a.birthday,"YYYY-MM-DD"):null,education:a.education,idcard:a.idcard,major:a.major,workduty:a.workduty,enterdate:null!==a.enterdate&&void 0!==a.enterdate?j()(a.enterdate,"YYYY-MM-DD"):null,workyears:a.workyears,majoryears:a.majoryears})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a={labelCol:{span:6},wrapperCol:{span:14}},t=JSON.parse(localStorage.getItem("userinfo")),r=this.state,s=r.passwordVisible,n=r.help,o=r.visible,i=r.OldPasswordVisible,p={handleOldPasswordVisible:this.handleOldPasswordVisible,handleOld:this.handleOld};return D.a.createElement(l["a"],{bordered:!1,size:"small"},D.a.createElement(C["a"],a,D.a.createElement(C["a"].Item,{label:"\u7528\u6237\u540d"},D.a.createElement("span",{className:"ant-form-text"},t.userName)),D.a.createElement(C["a"].Item,{label:"\u59d3\u540d"},D.a.createElement("span",{className:"ant-form-text"},t.nameC)),D.a.createElement(C["a"].Item,{label:"\u89d2\u8272"},D.a.createElement("span",{className:"ant-form-text"},t.role)),D.a.createElement(C["a"].Item,{label:"\u662f\u5426\u6388\u6743\u7b7e\u5b57\u4eba"},D.a.createElement("span",{className:"ant-form-text"},t.isauthorize)),D.a.createElement(C["a"].Item,{label:"\u5730\u5740"},e("place",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5730\u5740"}]})(D.a.createElement(N["a"],null))),D.a.createElement(C["a"].Item,{label:"\u624b\u673a"},e("tel",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u624b\u673a"}]})(D.a.createElement(N["a"],null))),D.a.createElement(C["a"].Item,{wrapperCol:{span:12,offset:6}},D.a.createElement(m["a"],{type:"primary",onClick:this.handleSubmit},"\u4fdd\u5b58"),D.a.createElement(m["a"],{type:"primary",style:{marginLeft:10},onClick:this.showPassword},"\u4fee\u6539\u5bc6\u7801"),D.a.createElement(m["a"],{type:"primary",style:{marginLeft:10},onClick:this.showPersonalInfo},"\u67e5\u770b"))),D.a.createElement(O["a"],{title:"\u4fee\u6539\u5bc6\u7801",visible:s,onOk:this.modifyPassword,onCancel:this.handlePasswordVisible},D.a.createElement(C["a"].Item,{label:"\u65b0\u5bc6\u7801:",help:n},D.a.createElement(d["a"],{getPopupContainer:function(e){return e.parentNode},content:D.a.createElement("div",{style:{padding:"4px 0"}},U[this.getPasswordStatus()],this.renderPasswordProgress(),D.a.createElement("div",{style:{marginTop:10}},D.a.createElement(J["FormattedMessage"],{id:"validation.password.strength.msg"}))),overlayStyle:{width:240},placement:"right",visible:o},e("password",{rules:[{validator:this.checkPassword,message:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"}]})(D.a.createElement(N["a"],{size:"large",type:"password",placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})))),D.a.createElement(C["a"].Item,{label:"\u786e\u8ba4\u65b0\u5bc6\u7801:"},e("confirm",{rules:[s?[{required:!0,message:"\u8bf7\u786e\u8ba4\u8f93\u5165\u65b0\u5bc6\u7801"}]:[],{validator:this.checkConfirm}]})(D.a.createElement(N["a"],{size:"large",type:"password",placeholder:"\u8bf7\u786e\u8ba4\u8f93\u5165\u65b0\u5bc6\u7801"})))),D.a.createElement(Z,c()({},p,{OldPasswordVisible:i})))}}]),t}(F["PureComponent"]),n=o))||n)||n);a["default"]=A}}]);