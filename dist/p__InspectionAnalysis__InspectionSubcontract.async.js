(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[109],{BwD7:function(e,t,a){"use strict";a.r(t);a("5NDa");var n,o,r,s=a("5rEg"),l=(a("giR+"),a("fyUT")),i=(a("7Kak"),a("9yH6")),c=(a("iQDF"),a("+eQT")),m=(a("IzEo"),a("bx4M")),p=(a("g9YV"),a("wCAj")),u=a("eHn4"),d=a.n(u),f=(a("2qtc"),a("kLXV")),h=(a("miYZ"),a("tsqr")),g=a("p0pE"),y=a.n(g),v=a("2Taf"),S=a.n(v),I=a("vZ4D"),E=a.n(I),C=a("MhPg"),b=a.n(C),w=a("l4Ni"),k=a.n(w),A=a("ujKo"),D=a.n(A),x=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),O=(a("sRBo"),a("kaz8")),F=a("q1tI"),N=a.n(F),T=a("MuoO"),P=a("3a4m"),M=a.n(P),V=a("zHco"),Y=a("glGN"),q=a.n(Y),J=a("wd/R"),z=a.n(J),B=(a("14J3"),a("BMrR")),j=(a("+L6B"),a("2/Rp")),L=(a("jCWc"),a("kPKH")),H=a("e+8u"),K=a.n(H);function Q(e){return function(){var t,a=D()(e);if(_()){var n=D()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return k()(this,t)}}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var G,Z,U,W,X=R["a"].Item,$=x["a"].Option,ee=(n=Object(T["connect"])(function(e){var t=e.inspectionAnalysis,a=e.loading;return{inspectionAnalysis:t,loading:a.models.inspectionAnalysis}}),n((r=function(e){b()(a,e);var t=Q(a);function a(){var e;S()(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o)),e.handleSearch=function(t){t.preventDefault();var a=e.props,n=a.dispatch,o=a.form,r=JSON.parse(localStorage.getItem("userinfo"));o.validateFields(function(e,t){if(console.log(e),!e){var a=y()({},t,{certCode:r.certCode,nameC:r.nameC,role:r.role,kind:t.kind,value:t.value});n({type:"inspectionAnalysis/getAllSampleAndTestCompany",payload:a})}})},e.handleFormReset=function(){var t=e.props.form;t.resetFields(),e.setState({formValues:{}});var a=JSON.parse(localStorage.getItem("userinfo")),n=e.props.dispatch;n({type:"inspectionAnalysis/getAllSampleAndTestCompany",payload:{certCode:a.certCode,nameC:a.nameC,role:a.role}})},e}return E()(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return N.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},N.a.createElement(B["a"],{gutter:{md:8,lg:24,xl:48}},N.a.createElement(L["a"],{md:4,sm:20},N.a.createElement(R["a"].Item,{labelCol:{span:5},wrapperCol:{span:6},colon:!1},e("kind",{rules:[{message:"\u641c\u7d22\u7c7b\u578b"}]})(N.a.createElement(x["a"],{placeholder:"\u641c\u7d22\u7c7b\u578b"},N.a.createElement($,{value:"m.reportno"},"\u59d4\u6258\u7f16\u53f7"),N.a.createElement($,{value:"shipname"},"\u8239\u540d\u6807\u8bc6"),N.a.createElement($,{value:"cargoname"},"\u68c0\u67e5\u54c1\u540d"),N.a.createElement($,{value:"sr.sampleno"},"\u6837\u54c1\u7f16\u53f7"),N.a.createElement($,{value:"samplename"},"\u6837\u54c1\u540d\u79f0"))))),N.a.createElement(L["a"],{md:6,sm:20},N.a.createElement(X,null,e("value",{rules:[{message:"\u641c\u7d22\u6570\u636e"}]})(N.a.createElement(s["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),N.a.createElement(L["a"],{md:8,sm:20},N.a.createElement("span",{className:K.a.submitButtons},N.a.createElement(j["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),N.a.createElement(j["a"],{style:{marginLeft:8},onClick:this.handleFormReset},"\u91cd\u7f6e")))))}}]),a}(F["PureComponent"]),o=r))||o),te=ee;function ae(e){return function(){var t,a=D()(e);if(ne()){var n=D()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return k()(this,t)}}function ne(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}O["a"].Group,R["a"].Item;var oe=x["a"].Option,re=R["a"].create()(te),se=(G=Object(T["connect"])(function(e){var t=e.inspectionAnalysis,a=e.loading;return{inspectionAnalysis:t,loading:a.models.inspectionAnalysis}}),Z=R["a"].create(),G(U=Z((W=function(e){b()(a,e);var t=ae(a);function a(){var e;S()(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o)),e.state={formValues:{},visible:!1,allCompanyName:[],selectEntrustment:null,showPrice:!0,isoperatevisible:!1,modalText:{}},e.columns=[{title:"\u59d4\u6258\u7f16\u53f7",dataIndex:"reportno"},{title:"\u59d4\u6258\u65e5\u671f",dataIndex:"reportdate",render:function(e){return N.a.createElement("span",null,z()(e).format("YYYY-MM-DD"))}},{title:"\u8239\u540d\u6807\u8bc6",dataIndex:"shipname"},{title:"\u68c0\u67e5\u54c1\u540d",dataIndex:"cargoname"},{title:"\u6837\u54c1\u7f16\u53f7",dataIndex:"sampleno"},{title:"\u6837\u54c1\u540d\u79f0",dataIndex:"samplename"},{title:"\u5206\u5305\u516c\u53f8",dataIndex:"testman"},{title:"\u72b6\u6001",dataIndex:"state"},{title:"\u64cd\u4f5c",render:function(t,a){return N.a.createElement(F["Fragment"],null,"\u5df2\u53d1\u5e03"===t.overallstate||"\u7533\u8bf7\u4f5c\u5e9f"===t.overallstate?[]:[void 0===t.testman||null===t.testman?[N.a.createElement("a",{onClick:function(){return e.show(t,a)}},"\u65b0\u5efa\xa0\xa0")]:[N.a.createElement("a",{onClick:function(){return e.detailItem(t,a)}},"\u4fee\u6539\xa0\xa0")]],N.a.createElement("a",{onClick:function(){return e.subcontractshow(t,a)}},"\u67e5\u770b\xa0\xa0"),N.a.createElement("a",{onClick:function(){return e.previewItem(t,a)}},"\u59d4\u6258\u8be6\u60c5"))}}],e.subcontractshow=function(e){sessionStorage.setItem("InspectionArrangementDetail_Report",JSON.stringify(e)),sessionStorage.setItem("reportno",e.reportno),sessionStorage.setItem("shipname",e.shipname),sessionStorage.setItem("applicant",e.applicant),sessionStorage.setItem("sampleno",e.sampleno),sessionStorage.setItem("overallstate_InspectionDetail",e.overallstate),M.a.push({pathname:"/InspectionAnalysis/InspectionSubcontractDetailView"})},e.previewItem=function(e){sessionStorage.setItem("reportno",e.reportno),window.open("/Entrustment/DetailForEntrustment"),localStorage.setItem("reportDetailNo",e.reportno)},e.detailItem=function(e){sessionStorage.setItem("InspectionArrangementDetail_Report",JSON.stringify(e)),sessionStorage.setItem("reportno",e.reportno),sessionStorage.setItem("shipname",e.shipname),sessionStorage.setItem("applicant",e.applicant),sessionStorage.setItem("sampleno",e.sampleno),sessionStorage.setItem("overallstate_InspectionDetail",e.overallstate),M.a.push({pathname:"/InspectionAnalysis/InspectionSubcontractDetail"})},e.handleOk=function(){var t=e.props,a=t.form.validateFieldsAndScroll,n=t.dispatch;a(function(t,a){var o=JSON.parse(localStorage.getItem("userinfo")),r=sessionStorage.getItem("reportno"),s=sessionStorage.getItem("sampleno");t||(n({type:"inspectionAnalysis/assign",payload:y()({},a,{assignman:o.nameC,assignsort:"\u54c1\u8d28\u5206\u5305",nameC:o.nameC,reportno:r,sampleno:s}),callback:function(t){200===t.code?(n({type:"inspectionAnalysis/getAllSample",payload:{certCode:o.certCode}}),h["a"].success("\u5206\u5305\u6210\u529f"),e.componentDidMount()):h["a"].error("\u5206\u5305\u5931\u8d25"),e.setState({visible:!1})}}),form.resetFields())})},e.show=function(t){"\u7533\u8bf7\u4f5c\u5e9f"!==t.overallstate&&"\u5df2\u53d1\u5e03"!==t.overallstate?(sessionStorage.setItem("reportno",t.reportno),sessionStorage.setItem("sampleno",t.sampleno),e.setState({modalText:t}),null===t.testman||void 0===t.testman?"\u5df2\u767b\u8bb0"===t.state?f["a"].confirm({title:"\u672a\u6dfb\u52a0\u6307\u6807\uff0c\u786e\u5b9a\u7ee7\u7eed\u5206\u5305\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){e.subcontract(t)}}):e.subcontract(t):f["a"].info({okText:"\u786e\u5b9a",title:"\u6837\u54c1\u5df2\u5206\u5305\uff0c\u8bf7\u67e5\u770b\u540e\u5220\u9664\uff0c\u53ef\u91cd\u65b0\u5206\u5305"})):f["a"].info({title:"\u8be5\u59d4\u6258\u5df2\u53d1\u5e03\uff0c\u65e0\u6cd5\u4fee\u6539\u5206\u5305\u4fe1\u606f\uff01",okText:"\u786e\u8ba4",onOk:function(){}})},e.subcontract=function(t){var a=e.props,n=a.form,o=a.dispatch;sessionStorage.setItem("reportno",t.reportno),sessionStorage.setItem("sampleno",t.sampleno),o({type:"inspectionAnalysis/getReport",payload:{reportno:t.reportno},callback:function(e){200===e.code&&n.setFieldsValue({inspwaymemo1:e.data.inspwaymemo1})}}),e.setState({visible:!0})},e.onChange=function(t){"\u6309\u5355\u4ef7"===t.target.value||"\u6309\u6bd4\u4f8b"===t.target.value?e.setState({showPrice:!0}):e.setState({showPrice:!1})},e.handleCancel=function(){e.setState({visible:!1})},e.sumPrice=function(t){var a=e.props.form,n=e.state.modalText.quantityd,o=t;if(void 0!==n&&""!==n&&""!==o&&void 0!==o){var r=o*n;r=r.toFixed(2),a.setFieldsValue(d()({},"totalfee",r))}},e.sum=function(){var t=e.props.form,a=t.getFieldValue("price"),n=e.state.modalText.quantityd;if(void 0!==n&&""!==n&&""!==a&&void 0!==a){var o=a*n;o=o.toFixed(2),t.setFieldsValue(d()({},"totalfee",o))}},e}return E()(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch,a=JSON.parse(localStorage.getItem("userinfo"));t({type:"inspectionAnalysis/getAllSampleAndTestCompany",payload:{certCode:a.certCode,nameC:a.nameC,role:a.role}}),t({type:"inspectionAnalysis/getCompany",payload:{certCode:a.certCode,type:"\u5b9e\u9a8c\u5ba4"},callback:function(t){e.setState({allCompanyName:t}),null!==t&&0!==t.length||f["a"].info({title:"\u5206\u5305\u65b9\u4fe1\u606f\u672a\u914d\u7f6e",content:"\u8bf7\u7ba1\u7406\u5458\u5728\u201c\u516c\u53f8\u7ba1\u7406-\u5206\u5305\u65b9\u201d\u83dc\u5355\u914d\u7f6e\uff01",okText:"\u77e5\u9053\u4e86",onOk:function(){}})}})}},{key:"render",value:function(){var e=this.props,t=e.inspectionAnalysis.samplesSubcontact,a=e.form.getFieldDecorator,n=e.loading,o=this.state,r=o.visible,u=o.allCompanyName,d=o.showPrice,h=u.map(function(e){return N.a.createElement(oe,{key:e,value:e},e)});return N.a.createElement(V["a"],{title:"\u68c0\u9a8c\u5b89\u6392"},N.a.createElement(m["a"],{bordered:!1,size:"small"},N.a.createElement("div",{className:q.a.tableList},N.a.createElement("div",{className:q.a.tableListForm},N.a.createElement(re,null)),N.a.createElement(p["a"],{style:{marginTop:5},size:"middle",loading:n,dataSource:t.list,pagination:{showQuickJumper:!0,showSizeChanger:!0},columns:this.columns,rowKey:"sampleno"}))),N.a.createElement(f["a"],{title:"\u5206\u5305",visible:r,onOk:this.handleOk,onCancel:this.handleCancel,style:{top:10}},N.a.createElement(R["a"],null,N.a.createElement(R["a"].Item,{label:"\u5206\u5305\u5b9e\u9a8c\u5ba4"},a("testman",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5206\u5305\u5b9e\u9a8c\u5ba4"}]})(N.a.createElement(x["a"],{showSearch:!0,placeholder:"\u8bf7\u9009\u62e9",filterOption:!1,onSearch:this.handleSearch},h))),N.a.createElement(R["a"].Item,{label:"\u5206\u5305\u65e5\u671f"},a("assigndate",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5206\u5305\u65e5\u671f"}]})(N.a.createElement(c["a"],{placeholder:"\u59d4\u6258\u65e5\u671f",style:{width:"100%"},format:"YYYY-MM-DD",getPopupContainer:function(e){return e.parentNode}}))),N.a.createElement(R["a"].Item,{label:"\u8ba1\u4ef7\u65b9\u5f0f"},a("priceway",{initialValue:"\u6309\u5355\u4ef7",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8ba1\u4ef7\u65b9\u5f0f"}]})(N.a.createElement(i["a"].Group,{onChange:this.onChange},N.a.createElement(i["a"],{value:"\u6309\u5355\u4ef7"},"\u6309\u5355\u4ef7"),N.a.createElement(i["a"],{value:"\u6309\u6279\u6b21"},"\u6309\u6279\u6b21")))),{true:N.a.createElement(R["a"].Item,{label:"\u5355\u4ef7"},a("price",{rules:!0===d?[{required:"true",message:"\u8bf7\u8f93\u5165\u5355\u4ef7"}]:[]})(N.a.createElement(l["a"],{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u5355\u4ef7",min:0,step:.01,onChange:this.sumPrice})))}[d],N.a.createElement(R["a"].Item,{label:"\u603b\u8ba1\u8d39\u7528"},a("totalfee",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u603b\u8ba1\u8d39\u7528"}]})(N.a.createElement(l["a"],{style:{width:"100%"},placeholder:"\u8bf7\u8f93\u5165\u603b\u8ba1\u8d39\u7528",min:0,step:.01,onBlur:this.sum}))),N.a.createElement(R["a"].Item,{label:" \u5907\u6ce8"},a("inspwaymemo1",{rules:[]})(N.a.createElement(s["a"],{placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8"}))))))}}]),a}(F["PureComponent"]),U=W))||U)||U);t["default"]=se}}]);